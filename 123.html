<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    #app {
  position: relative;
  overflow: hidden;
  margin: 0 auto;
  min-width: 1000px;
  min-height: 155px;
  height: 10vw;
  max-height: 240px;
}

.layer {
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

img {
  user-select: none;
  pointer-events: none;
}

</style>
<body>
    <div id="selectBox">
        <button id="1">æ°´ä¸‹ä¸–ç•Œ - ä¹Œé¾Ÿç‰ˆ</button> <button id="2">å¤§æµ·ä¹‹ä¸Š - é³„é±¼ç‰ˆ</button> <button id="3">æ£®æ— - çŒ´å­ç‰ˆ</button>
      </div>
      
      <div id="app">loading...</div>
      
      
</body>

<script>
const barnerImagesData1 = [
  {
    url: 'https://pic.imgdb.cn/item/64d89f131ddac507ccdb7db2.webp',
    transform: [1, 0, 0, 1, 0, 0],
    width: 1950,
    a: 0.01
  },
  {
    url: 'https://pic.imgdb.cn/item/64d89f821ddac507ccdc71e4.webp',
    transform: [1, 0, 0, 1, -240, -5],
    width: 457.5,
    deg: -Math.PI / 60000,
    a: 0.035,
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f561ddac507ccdc10d9.webp',
    transform: [1, 0, 0, 1, -300, 45],
    width: 157.5,
    deg: -Math.PI / 15000,
    a: 0.03,
    g: -0.02
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f811ddac507ccdc715c.webp',
    transform: [1, 0, 0, 1, -180, 0],
    width: 314.3,
    a: -0.035
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f7c1ddac507ccdc64c2.webp',
    transform: [1, 0, 0, 1, -300, 20],
    width: 571.2,
    deg: Math.PI / 40000,
    a: 0.05
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f7c1ddac507ccdc65e6.webp',
    transform: [1, 0, 0, 1, 100, 0],
    width: 1446,
    a: 0.01
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f7c1ddac507ccdc655c.webp',
    transform: [1, 0, 0, 1, 220, 0],
    width: 158.25,
    deg: Math.PI / 10000,
    a: 0.06,
    g: 0.045
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f7c1ddac507ccdc6536.webp',
    transform: [1, 0, 0, 1, -240, 0],
    width: 1721.3,
    a: 0.01
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f811ddac507ccdc7133.webp',
    transform: [1, 0, 0, 1, 320, 0],
    width: 642.96,
    a: 0.075,
    g: -0.025
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f7c1ddac507ccdc649b.webp',
    transform: [1, 0, 0, 1, 20, 0],
    blur: 1,
    width: 2131.5,
    a: 0.18
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f5c1ddac507ccdc1bbd.webp',
    transform: [1, 0, 0, 1, 400, 0],
    blur: 2.5,
    width: 299.52,
    deg: -Math.PI / 30000,
    a: 0.15,
    g: -0.02
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f571ddac507ccdc113d.webp',
    transform: [1, 0, 0, 1, 0, 10],
    width: 457.1,
    deg: Math.PI / 20000,
    f: 0.0001,
    a: 0.06,
    g: 0.01
  },
   {
    url: 'https://pic.imgdb.cn/item/64d89f561ddac507ccdc10aa.webp',
    transform: [1, 0, 0, 1, -150, 0],
    width: 419.2,
    opacity: [0.1, 1],
    a: -0.02
  },
  {
    url: 'https://pic.imgdb.cn/item/64d89f561ddac507ccdc1077.webp',
    transform: [1, 0, 0, 1, 40, 10],
    width: 816.9,
    blur: 1,
    a: 0.09
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f561ddac507ccdc102a.webp',
    transform: [1, 0, 0, 1, 20, 0],
    blur: 3,
    width: 1805.6,
    a: 0.3
  }, {
    url: 'https://pic.imgdb.cn/item/64d89f821ddac507ccdc71c6.webp',
    transform: [1, 0, 0, 1, 0, 0],
    width: 2400,
    a: 0.25
  }]


  const barnerImagesData2 = [
  {
    "width": 1916,
    "height": 179,
    url: 'https://pic.imgdb.cn/item/64e08056661c6c8e540748c5.webp',
    "transform": [1, 0, 0, 1, 0, 0],
    a: 0.01
  },
  {
    "width": 690,
    "height": 56,
    url: 'https://pic.imgdb.cn/item/64e0808e661c6c8e5407fb3d.webp',
    "transform": [1, 0, 0, 1, 95.8065, -19.1613],
    a: 0.02
  },
  {
    "width": 1360,
    "height": 179,
    url: 'https://pic.imgdb.cn/item/64e083b8661c6c8e5411820c.webp',
    "transform": [1, 0, 0, 1, 223.548, 9.58065],
    a: 0.015
  },
  {
    "width": 1781,
    "height": 179,
    url: 'https://pic.imgdb.cn/item/64e083cf661c6c8e5411c5d2.webp',
    "transform": [1, 0, 0, 1, -102.194, 6.3871],
    a: 0.02
  },
  {
    "width": 911,
    "height": 141,
    "url": "https://pic.imgdb.cn/item/64e083e5661c6c8e541200a9.webp",
    "transform": [1, 0, 0, 1, -127.742, 25.5484],
    a: 0.04,
    opacity: [1, 0]
  },
  {
    "width": 911,
    "height": 141,
    "url": "https://pic.imgdb.cn/item/64e08404661c6c8e541256f4.webp",
    "transform": [1, 0, 0, 1, -127.742, 25.5484],
    a: 0.04,
    opacity: [0, 1],
  },
  {
    "width": 84,
    "height": 45,
    "url": "https://pic.imgdb.cn/item/64e0840d661c6c8e541271aa.webp",
    "transform": [1, 0, 0, 1, -558.871, 37.2581],
    a: 0.02
  },
  {
    "width": 201,
    "height": 103,
    "url": "https://pic.imgdb.cn/item/64e08416661c6c8e541289a1.webp",
    "transform": [1, 0, 0, 1, -606.774, 44.7097],
    a: 0.1
  },
  {
    "width": 95,
    "height": 34,
    "url": "https://pic.imgdb.cn/item/64e08421661c6c8e5412a883.webp",
    "transform": [1, 0, 0, 1, 380.565, 76.1129],
    a: 0.07
  },
  {
    "width": 68,
    "height": 40,
    "url": "https://pic.imgdb.cn/item/64e0842c661c6c8e5412c88f.webp",
    "transform": [1, 0, 0, 1, 63.871, 0],
    a: 0.075,
    deg: -Math.PI / 40000,
    g: -0.0075
  },
  {
    "width": 304,
    "height": 116,
    "url": "https://pic.imgdb.cn/item/64e08435661c6c8e5412e1ee.webp",
    "transform": [1, 0, 0, 1, -127.742, 12.7742],
    a: 0.04
  },
  {
    "width": 259,
    "height": 64,
    "url": "https://pic.imgdb.cn/item/64e0843c661c6c8e5412f5b4.webp",
    "transform": [1, 0, 0, 1, -193.742, 41.5161],
    a: 0.04,
    deg: Math.PI / 40000,
  },
  {
    "width": 1980,
    "height": 221,
    "url": "https://pic.imgdb.cn/item/64e08445661c6c8e54130dee.webp",
    "transform": [1, 0, 0, 1, -23.9516, -3.99194],
    a: 0.07
  },
  {
    "width": 196,
    "height": 88,
    "url": "https://pic.imgdb.cn/item/64e0844c661c6c8e54132471.webp",
    "transform": [1, 0, 0, 1, -268.258, -51.0968],
    a: 0.16
  },
  {
    "width": 2235,
    "height": 209,
    "url": "https://pic.imgdb.cn/item/64e08455661c6c8e54133dda.webp",
    "transform": [1, 0, 0, 1, 0, -14.9032],
    a: 0.16,
    blur: 3
  }
]

 const barnerImagesData3 = [
  {
    "width": 1920,
    "height": 180,
    url: 'https://i0.hdslb.com/bfs/vc/01b79b5b5b38d7305a0ca1780c24662cc5a59f18.png@1c.webp',
    "transform": [1, 0, 0, 1, 0, 0],
    a: 0.01
  },
  {
    "width": 1920,
    "height": 180,
    url: 'https://i0.hdslb.com/bfs/vc/fe903820ca0f604ef24f16ff7ad51192ead3d0c8.png@1c.webp',
    "transform": [1, 0, 0, 1, 0, 0],
    a: 0.02
  },
  {
    "width": 1920,
    "height": 164,
    url: 'https://i0.hdslb.com/bfs/vc/73fcb8a56776307147c140f68bf9c5793696ae88.png@1c.webp',
    "transform": [1, 0, 0, 1, 0, 9.58065],
    a: 0.015
  },
  {
    "width": 826,
    "height": 76,
    url: 'https://i0.hdslb.com/bfs/vc/b8a5bcf77a07793ce50294a8cb14a9fb8f2cea83.png@1c.webp',
    "transform": [1, 0, 0, 1, -70.194, -44.3871],
    a: 0.02
  },
  {
    "width": 1523,
    "height": 180,
    "url": "https://i0.hdslb.com/bfs/vc/1fd3d44b8f890b88cf52f6bcc041326b30e7cb62.png@1c.webp",
    "transform": [1, 0, 0, 1, 89.742, 15.5484],
    a: 0.04,
  },
  {
    "width": 420,
    "height": 54,
    "url": "https://i0.hdslb.com/bfs/vc/085bc5e7f70b625b62c1f5d374f55acbd828ab65.png@1c.webp",
    "transform": [1, 0, 0, 1, -183.742, -46.5484],
    a: 0.04,
  },
  {
    "width": 1920,
    "height": 16,
    "url": "https://i0.hdslb.com/bfs/vc/3e16264878dd88c1b8ead37aab07a9363186b18c.png@1c.webp",
    "transform": [1, 0, 0, 1, 6.871, 37.2581],
    a: 0.02
  },
  {
    "width": 104,
    "height": 109,
    "url": "https://i0.hdslb.com/bfs/vc/8902051ab71c8093a85ce2a71882054ee91ea631.png@1c.webp",
    "transform": [1, 0, 0, 1, 262.774, -27.0],
    a: 0.06
  },
  {
    "width": 589,
    "height": 180,
    "url": "	https://i0.hdslb.com/bfs/vc/c9231e763120806f3e918d06ad3f415e920c2b73.png@1c.webp",
    "transform": [1, 0, 0, 1, 630.565, 15.1129],
    a: 0.07
  },
  {
    "width": 420,
    "height": 157,
    "url": "	https://i0.hdslb.com/bfs/vc/67a3c27832d63060d88fbd7bdb2fc543e3fb9ddf.png@1c.webp",
    "transform": [1, 0, 0, 1, 714.871, 10],
    a: 0.075,
  },
  {
    "width": 389,
    "height": 149,
    "url": "	https://i0.hdslb.com/bfs/vc/c651a0183b81857191c86b133c5a777059b13571.png@1c.webp",
    "transform": [1, 0, 0, 1, 527.742, 27.7742],
    a: 0.07
  },
  {
    "width": 204,
    "height": 148,
    "url": "https://i0.hdslb.com/bfs/vc/6afc90f36610318b4785a52c1a51ef6f1de9d25b.png@1c.webp",
    "transform": [1, 0, 0, 1, 585.742, 15.5161],
    a: 0.04,
    deg: Math.PI / 40000,
  },
  {
    "width": 226,
    "height": 116,
    "url": "	https://i0.hdslb.com/bfs/vc/476679726643b3b6cc5599b882d85953ef34f3d9.png@1c.webp",
    "transform": [1, 0, 0, 1, -198.9516, -5.99194],
    a: 0.07
  },
  {
    "width": 823,
    "height": 180,
    "url": "	https://i0.hdslb.com/bfs/vc/121335f79c78bb6f47e4fc7dae4b0af0eac804bb.png@1c.webp",
    "transform": [1, 0, 0, 1, -627.258, 0],
    a: 0.16
  },
  {
    "width": 307,
    "height": 112,
    "url": "https://i0.hdslb.com/bfs/vc/590a6dd64ff00d5d0e63e230188939c405253452.png@1c.webp",
    "transform": [1, 0, 0, 1, -426.129, 27.9032],
    a: 0.16,
  }
]




const body = document.getElementById('app')
const lerp = (start, end, amt) => (1 - amt) * start + amt * end; // è®¡ç®—çº¿æ€§æ’å€¼
// import { barnerImagesData1, barnerImagesData2 } from 'https://code.juejin.cn/api/raw/7267103634863702050?id=7267103634863751202'
const barnersData = [barnerImagesData1, barnerImagesData2,barnerImagesData3]
let allImagesData = barnerImagesData1

let compensate = 0 // è§†çª—è¡¥å¿å€¼
let layers = [] // DOMé›†åˆ

document.getElementById('selectBox').addEventListener("click", (e) => {
    console.log('ğŸ­-----e-----', e.target);
  const setData = barnersData[+e.target.id - 1]
  if (!setData) return
  allImagesData = setData
  body.innerHTML = ""
  layers = []
  initItems()
})

// æ·»åŠ å›¾ç‰‡å…ƒç´ 
function initItems() {
  compensate = window.innerWidth > 1650 ? window.innerWidth / 1650 : 1
  if (layers.length <= 0) {
    body.style.display = 'none'
    for (let i = 0; i < allImagesData.length; i++) {
      const item = allImagesData[i]
      const layer = document.createElement('div')
      layer.classList.add('layer')
      layer.style = 'transform:' + new DOMMatrix(item.transform)
      item.opacity && (layer.style.opacity = item.opacity[0])
      const img = document.createElement('img')
      img.src = item.url
      img.style.filter = `blur(${item.blur}px)`
      img.style.width = `${item.width * compensate}px`
      layer.appendChild(img)
      body.appendChild(layer)
    }
    body.style.display = ''
    layers = document.querySelectorAll(".layer")
  } else {
    for (let i = 0; i < layers.length; i++) {
      layers[i].firstElementChild.style.width = `${allImagesData[i].width * compensate}px`
    }
  }
}
initItems()

let initX = 0
let moveX = 0
let startTime = 0;
const duration = 300; // åŠ¨ç”»æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
function mouseMove() { // æ»‘åŠ¨æ“ä½œ
  animate()
}
function leave() {
  startTime = 0;
  requestAnimationFrame(homing); // å¼€å§‹åŠ¨ç”»
}
function homing(timestamp) {
  !startTime && (startTime = timestamp)
  const elapsed = timestamp - startTime
  const progress = Math.min(elapsed / duration, 1)
  animate(progress) // ä¼ é€’åŠ¨ç”»è¿›åº¦
  progress < 1 && requestAnimationFrame(homing) // ç»§ç»­ä¸‹ä¸€å¸§
}
// åŠ¨ç”»æ‰§è¡Œ
function animate(progress) {
  if(layers.length <= 0) return
  const isHoming = typeof progress === 'number'
  for (let i = 0; i < layers.length; i++) {
    const layer = layers[i];
    const item = allImagesData[i]
    let m = new DOMMatrix(item.transform)
    let move = moveX * item.a // ç§»åŠ¨X translateX
    let s = item.f ? item.f * moveX + 1 : 1 // æ”¾å¤§æ¯”ä¾‹ Scale
    let g = moveX * (item.g || 0) // ç§»åŠ¨Y translateY
    if (isHoming) { // å›æ­£æ—¶å¤„ç†
      m.e = lerp(moveX * item.a + item.transform[4], item.transform[4], progress)
      move = 0
      s = lerp(item.f ? item.f * moveX + 1 : 1, 1, progress)
      g = lerp(item.g ? item.g * moveX : 0, 0, progress)
    }
    m = m.multiply(new DOMMatrix([m.a * s, m.b, m.c, m.d * s, move, g]))
    if (item.deg) { // æœ‰æ—‹è½¬è§’åº¦
      const deg = isHoming ? lerp(item.deg * moveX, 0, progress) : item.deg * moveX
      m = m.multiply(new DOMMatrix([Math.cos(deg), Math.sin(deg), -Math.sin(deg), Math.cos(deg), 0, 0]))
    }
    if (item.opacity) { // æœ‰é€æ˜åº¦å˜åŒ–
      layer.style.opacity = isHoming && moveX > 0 ? lerp(item.opacity[1], item.opacity[0], progress) : lerp(item.opacity[0], item.opacity[1], moveX / window.innerWidth * 2)
    }
    layer.style.transform = m // åº”ç”¨æ‰€æœ‰å˜æ¢æ•ˆæœ
  }
}
// é¼ æ ‡æ»‘å…¥ä¸æ»‘åŠ¨
body.addEventListener('mouseover', (e) => initX = e.pageX)
body.addEventListener('mousemove', (e) => {
  moveX = e.pageX - initX
  requestAnimationFrame(mouseMove)
})
// é¼ æ ‡å·²ç»ç¦»å¼€äº†è§†çª—æˆ–è€…åˆ‡å‡ºæµè§ˆå™¨ï¼Œæ‰§è¡Œå›æ­£åŠ¨ç”»
body.addEventListener("mouseleave", leave)
// document.addEventListener("mouseleave", leave)
window.onblur = leave
// æ·»åŠ çª—å£å¤§å°ç›‘å¬
window.addEventListener('resize', initItems)



</script>
</html>